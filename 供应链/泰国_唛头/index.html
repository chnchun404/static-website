<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>泰国-唛头</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        primaryLight: '#E8F3FF',
                        primaryDark: '#0E42CC',
                        secondary: '#0E2B8A',
                        light: '#F9FBFF',
                        dark: '#1D2129',
                        gray: '#86909C',
                        grayLight: '#F0F2F5',
                        grayBorder: '#E5E6EB'
                    },
                    fontFamily: {
                        sans: ['Microsoft YaHei', 'PingFang SC', 'sans-serif']
                    },
                    boxShadow: {
                        'card': '0 2px 12px 0 rgba(0, 0, 0, 0.05)',
                        'card-hover': '0 6px 16px 0 rgba(0, 0, 0, 0.08)',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .collapse-item {
                border-bottom: 1px solid theme('colors.grayBorder');
            }
            /* 折叠面板核心样式（修复联动逻辑） */
            .collapse-header {
                cursor: pointer;
                transition: all 0.2s ease;
            }
            .collapse-content {
                max-height: 0;
                opacity: 0;
                transition: all 0.4s ease-in-out;
                overflow: hidden;
                padding-top: 0;
            }
            /* 激活状态下展开内容 */
            .collapse-header.active + .collapse-content {
                max-height: 2000px;
                opacity: 1;
                padding-top: 1rem;
            }
            /* 折叠图标旋转动画（优化过渡） */
            .collapse-header .fa-chevron-down {
                transition: transform 0.3s ease-in-out;
                display: inline-block; /* 确保旋转生效 */
            }
            .collapse-header.active .fa-chevron-down {
                transform: rotate(180deg);
            }
            .step-card {
                border-left: 3px solid theme('colors.primaryLight');
                padding-left: 1rem;
                margin-bottom: 1.5rem;
                position: relative;
            }
            .step-card::before {
                content: '';
                position: absolute;
                left: -3px;
                top: 0;
                height: 100%;
                width: 3px;
                background: linear-gradient(to bottom, theme('colors.primary'), transparent);
                opacity: 0.3;
            }
            .table-hover-row {
                transition: background-color 0.2s ease;
            }
        }
    </style>
</head>
<body class="bg-light text-dark font-sans min-h-screen">
    
    <!-- 页面头部 -->
    <header class="py-8 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-white to-primaryLight">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-[clamp(22px,4vw,32px)] font-bold text-secondary mb-3">
                泰国_唛头自动化流程
            </h1>
            <p class="text-gray text-base sm:text-lg max-w-3xl mx-auto">
                采购单解析 · 模板写入 · 标签下载 · 微信发送 · 订单备注标记 | 替代人工操作，提升效率与准确性
            </p>
        </div>
    </header>

    <main class="max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8 space-y-6">
        <!-- 板块1：业务背景 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-bullseye text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">一、业务背景</h2>
            </div>
            <!-- 实施目的 -->
            <div class="pl-12 text-base leading-relaxed text-dark/85 mb-6">
                <h3 class="font-medium text-dark mb-2">1.1 实施目的</h3>
                <p>供应链部门需处理泰国站点2仓/5仓/6仓采购单，解析采购备注中的仓库、物流方式（陆运/海运）、装箱数量等信息，完成模板写入、截图、标签/箱标PDF下载、微信发送至对应供应商群、订单备注标记“已给”等操作。</p>
                <p class="mt-2">人工处理上述流程繁琐且易出错，通过<b class="text-primary">全流程自动化设计</b>，解决人工操作痛点，提升处理效率与数据准确性。</p>
            </div>
            <!-- 基本信息 -->
            <div class="pl-12 overflow-x-auto">
                <h3 class="font-medium text-dark mb-2">1.2 基础信息</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr class="bg-primaryLight text-left">
                            <th class="p-3 border border-grayBorder font-medium text-primary">流程名称</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">所属部门</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">操作频率</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">单次耗时</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">海仓_马帮ERP-采购管理-采购信息同步至卖头方-泰国</td>
                            <td class="p-3 border border-grayBorder">供应链</td>
                            <td class="p-3 border border-grayBorder">按需执行（定时/手动触发）</td>
                            <td class="p-3 border border-grayBorder">自动化：3~5分钟/条</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 板块2：功能模块 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-desktop text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">二、功能模块</h2>
            </div>
            <!-- 应用系统 -->
            <div class="pl-12 mb-6">
                <h3 class="font-medium text-dark mb-2">2.1 涉及应用系统</h3>
                <p class="text-sm text-dark/80 mb-3">系统类型：浏览器网页/客户端 | 验证码类型：无</p>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse text-sm">
                        <thead>
                            <tr class="bg-primaryLight text-left">
                                <th class="p-3 border border-grayBorder font-medium text-primary">系统名称</th>
                                <th class="p-3 border border-grayBorder font-medium text-primary">类型</th>
                                <th class="p-3 border border-grayBorder font-medium text-primary">需账号密码</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">马帮ERP</td>
                                <td class="p-3 border border-grayBorder">浏览器网页</td>
                                <td class="p-3 border border-grayBorder">Yes</td>
                            </tr>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">海仓国际</td>
                                <td class="p-3 border border-grayBorder">浏览器网页</td>
                                <td class="p-3 border border-grayBorder">Yes</td>
                            </tr>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">WPS（Word/Excel）</td>
                                <td class="p-3 border border-grayBorder">客户端</td>
                                <td class="p-3 border border-grayBorder">无</td>
                            </tr>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">微信</td>
                                <td class="p-3 border border-grayBorder">客户端</td>
                                <td class="p-3 border border-grayBorder">Yes（需登录）</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- 模块概览 -->
            <div class="pl-12 overflow-x-auto">
                <h3 class="font-medium text-dark mb-2">2.2 核心模块概览</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr class="bg-primaryLight text-left">
                            <th class="p-3 border border-grayBorder font-medium text-primary">模块名称</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">涉及系统</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">马帮ERP登录与采购单查询</td>
                            <td class="p-3 border border-grayBorder">马帮ERP</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">采购单备注解析（仓库/物流/箱数）</td>
                            <td class="p-3 border border-grayBorder">马帮ERP</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">海仓国际登录与商品标签下载</td>
                            <td class="p-3 border border-grayBorder">海仓国际</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">海仓入库订单创建与箱标PDF下载</td>
                            <td class="p-3 border border-grayBorder">海仓国际</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">Word模板写入与截图</td>
                            <td class="p-3 border border-grayBorder">WPS（Word）</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">微信发送截图/PDF/采购单号</td>
                            <td class="p-3 border border-grayBorder">微信</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">马帮订单备注标记“已给”</td>
                            <td class="p-3 border border-grayBorder">马帮ERP</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">流程回执单生成</td>
                            <td class="p-3 border border-grayBorder">WPS（Excel）</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 板块3：异常处理机制 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-exclamation-triangle text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">三、异常处理机制</h2>
            </div>
            <div class="pl-12 space-y-3" id="exception-section">
                <!-- 全部展开/收起按钮 -->
                <div class="collapse-header flex justify-between items-center py-3 px-4 bg-primaryLight/50 rounded-lg hover:bg-primaryLight/80" id="allCollapseBtn">
                    <span class="font-medium text-primary">展开/收起所有异常处理规则</span>
                    <i class="fa fa-chevron-down text-xs text-primary"></i>
                </div>

                <!-- 步骤1：马帮ERP登录 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤1：马帮ERP系统登录</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>登录前校验当前登录用户，不一致则退出重新登录</li>
                                <li>登录失败触发重试机制（次数由retry_times控制），每次失败记录日志</li>
                                <li>页面加载超时（300秒）则判定登录失败，抛出异常</li>
                                <li>登录超时后重新创建浏览器窗口，最大化加载页面</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤2：采购单查询与解析 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤2：采购单查询与备注解析</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>单条采购单包含多个SKU则标记失败，跳过处理</li>
                                <li>采购备注/订单备注无仓库信息则标记失败，记录原因</li>
                                <li>备注中无物流方式（陆运/海运）则默认填充“海运”</li>
                                <li>无法解析箱数/数量则标记失败，需人工确认</li>
                                <li>非整箱（箱数为小数）则跳过处理，标记失败</li>
                                <li>采购数量小于装箱规格则标记失败，需人工确认</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤3：海仓国际登录与标签下载 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤3：海仓国际登录与标签下载</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>海仓登录超时（300秒）则触发重试，最多重试10次（每次间隔60秒）</li>
                                <li>商品资料库未找到对应SKU则标记失败，需人工维护</li>
                                <li>标签PDF下载超时（800秒）则重试，失败则标记异常</li>
                                <li>本地标签文件已存在则跳过下载，直接使用现有文件</li>
                                <li>打印窗口未弹出则重试点击，失败则抛出异常</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤4：箱标生成与PDF下载 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤4：入库订单创建与箱标PDF下载</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>入库订单创建时未找到SKU则关闭弹窗，标记失败</li>
                                <li>箱标PDF下载失败则触发二次重试，仍失败则标记异常</li>
                                <li>入库订单搜索结果为空则标记失败，需人工确认</li>
                                <li>打印窗口加载超时（30秒）则抛出异常</li>
                                <li>海仓系统维护导致页面无法访问则跳过，记录日志</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤5：模板写入与截图 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤5：Word模板写入与截图</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>Word模板打开失败则重试（最多10次），失败则标记异常</li>
                                <li>截图保存到本地失败则关闭Word，标记失败</li>
                                <li>模板写入时字体/格式设置失败则记录日志，继续执行</li>
                                <li>截图区域定位错误则调整坐标，重试截图</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤6：微信发送 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤6：微信发送截图/PDF/采购单号</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>微信未登录则将文件备份到本地，标记需人工发送</li>
                                <li>未找到对应供应商群聊则标记失败，需人工确认</li>
                                <li>文件发送失败则重试，失败则记录日志</li>
                                <li>发送后校验是否成功，失败则标记异常</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤7：订单备注标记 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤7：马帮订单备注标记“已给”</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>备注输入框未激活则重试点击，失败则标记异常</li>
                                <li>标记后未显示“操作成功”弹窗则标记失败，需人工确认</li>
                                <li>重复标记“已给”则跳过，避免重复写入</li>
                                <li>马帮页面超时则重新加载，重试标记</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 板块4：数据传输规范 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-exchange text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">四、数据传输规范</h2>
            </div>
            <div class="pl-12 space-y-3" id="data-section">
                <!-- 全部展开/收起按钮 -->
                <div class="collapse-header flex justify-between items-center py-3 px-4 bg-primaryLight/50 rounded-lg hover:bg-primaryLight/80" id="allCollapseBtn2">
                    <span class="font-medium text-primary">展开/收起所有数据传输规则</span>
                    <i class="fa fa-chevron-down text-xs text-primary"></i>
                </div>

                <!-- 规则1：采购单信息解析 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则1：采购单备注信息解析规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>仓库解析：匹配备注中“1仓/一仓/2仓/二仓/5仓/五仓”关键词，无则标记失败</li>
                                <li>物流方式解析：优先匹配“陆运/海运”，无则默认填充“海运”</li>
                                <li>箱数解析：正则匹配“X箱陆运/X箱海运”或“陆运X箱/海运X箱”，提取箱数</li>
                                <li>数量解析：采购数量 ÷ 箱数 = 每箱数量，非整数则标记失败</li>
                                <li>多物流方式解析：陆运+海运数量需等于采购总数量，否则标记失败</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则2：模板写入规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则2：Word模板写入规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>模板清空：先清空原有内容，重置字体为微软雅黑、36磅、加粗、居中</li>
                                <li>SKU写入：去除前缀“QM_”后写入，格式为“SKU:XXX”</li>
                                <li>数量写入：格式为“数量:XXX”（每箱数量）</li>
                                <li>箱数写入：格式为“共XXX箱”</li>
                                <li>仓库编码写入：1仓=XN-CSD2116、2仓=CSD1096、5仓=CSD9966</li>
                                <li>物流方式写入：格式为“陆运/海运”</li>
                                <li>采购单号写入：格式为“采购单号:XXX”</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则3：文件存储规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则3：文件命名与存储规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>标签PDF命名：产品标签{SKU}.pdf，存储到配置的QM_LABEL_FOLDER_PATH目录</li>
                                <li>截图命名：{采购单号}_{物流方式}_{供应商}.png，存储到“截图与链接备份/时间/泰国/采购单号”目录</li>
                                <li>箱标PDF命名：{海仓入库单号}.pdf，存储到“截图与链接备份/时间/泰国/采购单号”目录</li>
                                <li>回执单命名：{时间戳}_回执单.xlsx，存储到“回执单”目录</li>
                                <li>所有文件存储前先创建目录，确保路径存在</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则4：微信发送规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则4：微信发送内容规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>发送对象：供应商编码模板中匹配的对应微信群聊</li>
                                <li>发送内容顺序：模板截图 → 箱标PDF → 标签PDF → 采购单号</li>
                                <li>发送失败处理：文件备份到本地，标记需人工发送</li>
                                <li>发送成功标记：回执单中“已发送到微信群聊”字段填充群聊名称</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则5：回执单生成规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则5：流程回执单生成规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>回执单字段：采购单号、库存SKU、供应商、站点、运输方式、模板是否重新写入、是否成功截图、箱标PDF是否下载、标签PDF是否下载、已发送到微信群聊、是否登记为已给、状态、失败原因</li>
                                <li>状态值：成功/失败（失败需填充失败原因）</li>
                                <li>存储位置：回执单目录 + 备份到截图与链接备份目录</li>
                                <li>编码格式：UTF-8，无索引列，字段顺序固定</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则6：订单备注标记规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则6：订单备注标记规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>字段：采购单号、库存SKU、供应商、站点、运输方式、模板是否重新写入、是否成功截图、箱标PDF是否下载、标签PDF是否下载、已发送到微信群聊、是否登记为已给、状态、失败原因</li>
                                <li>状态值：成功/失败（失败需填充具体原因）</li>
                                <li>存储：回执单目录 + 备份到截图与链接备份目录</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 板块5：系统依赖 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-cogs text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">五、系统依赖</h2>
            </div>
            <div class="pl-12 space-y-4">
                <div class="bg-grayLight p-4 rounded-lg">
                    <h3 class="font-medium text-dark mb-2">5.1 基础环境</h3>
                    <ul class="list-disc pl-6 space-y-1 text-sm">
                        <li>操作系统：Windows（依赖win32系列库）</li>
                        <li>编程语言：Python 3.x</li>
                    </ul>
                </div>
                <div class="bg-grayLight p-4 rounded-lg">
                    <h3 class="font-medium text-dark mb-2">5.2 核心Python库</h3>
                    <ul class="list-disc pl-6 space-y-1 text-sm">
                        <li>自动化类：xbot（网页/客户端自动化）、pyautogui（截图/键鼠模拟）、win32com（WPS操作）</li>
                        <li>数据处理类：pandas（Excel回执单生成）、re（备注正则解析）</li>
                        <li>文件处理类：docx（Word模板操作）、PIL（截图处理）、os/shutil（文件/目录管理）</li>
                        <li>日志类：xbot.app.logging（流程日志记录）</li>
                    </ul>
                </div>
                <div class="bg-grayLight p-4 rounded-lg">
                    <h3 class="font-medium text-dark mb-2">5.3 第三方系统</h3>
                    <ul class="list-disc pl-6 space-y-1 text-sm">
                        <li>马帮ERP：https://www.mabangerp.com（采购管理、库存SKU、分仓调拨）</li>
                        <li>海仓国际：含“seacang”关键词的网页（商品管理、入库订单）</li>
                        <li>WPS Office：Word模板编辑、Excel回执单生成</li>
                        <li>微信PC端：文件与文本消息发送</li>
                    </ul>
                </div>
            </div>
        </section>
        </main>

    <script>
        // 单个面板点击事件
        const panelHeaders = document.querySelectorAll('.collapse-header');
        const allCollapseBtn = document.getElementById('allCollapseBtn');
        const allCollapseBtn2 = document.getElementById('allCollapseBtn2');
        let isExceptionAllExpanded = false; // 异常板块独立状态
        let isDataAllExpanded = false; // 数据板块独立状态

        // 单个面板切换
        panelHeaders.forEach(header => {
            header.addEventListener('click', () => {
                // 排除“全部展开/收起”按钮
                if (header.id !== 'allCollapseBtn' && header.id !== 'allCollapseBtn2') {
                    header.classList.toggle('active');
                }
            });
        });

        // 全部展开/收起（异常处理板块）
        allCollapseBtn.addEventListener('click', () => {
            isExceptionAllExpanded = !isExceptionAllExpanded;
            const sectionHeaders = document.querySelectorAll('#exception-section .collapse-header:not(#allCollapseBtn)');
            sectionHeaders.forEach(header => {
                header.classList.toggle('active', isExceptionAllExpanded);
            });
            allCollapseBtn.innerHTML = isExceptionAllExpanded 
                ? '<span class="font-medium text-primary">收起所有异常处理规则</span><i class="fa fa-chevron-down text-xs text-primary"></i>'
                : '<span class="font-medium text-primary">展开所有异常处理规则</span><i class="fa fa-chevron-down text-xs text-primary"></i>';
        });

        // 全部展开/收起（数据传输板块）
        allCollapseBtn2.addEventListener('click', () => {
            isDataAllExpanded = !isDataAllExpanded;
            const sectionHeaders = document.querySelectorAll('#data-section .collapse-header:not(#allCollapseBtn2)');
            sectionHeaders.forEach(header => {
                header.classList.toggle('active', isDataAllExpanded);
            });
            allCollapseBtn2.innerHTML = isDataAllExpanded
                ? '<span class="font-medium text-primary">收起所有数据传输规则</span><i class="fa fa-chevron-down text-xs text-primary"></i>'
                : '<span class="font-medium text-primary">展开所有数据传输规则</span><i class="fa fa-chevron-down text-xs text-primary"></i>';
        });
    </script>
</body>
</html>