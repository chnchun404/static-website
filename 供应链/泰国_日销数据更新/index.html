<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>泰国_进销存更新</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        primaryLight: '#E8F3FF',
                        primaryDark: '#0E42CC',
                        secondary: '#0E2B8A',
                        light: '#F9FBFF',
                        dark: '#1D2129',
                        gray: '#86909C',
                        grayLight: '#F0F2F5',
                        grayBorder: '#E5E6EB'
                    },
                    fontFamily: {
                        sans: ['Microsoft YaHei', 'PingFang SC', 'sans-serif']
                    },
                    boxShadow: {
                        'card': '0 2px 12px 0 rgba(0, 0, 0, 0.05)',
                        'card-hover': '0 6px 16px 0 rgba(0, 0, 0, 0.08)',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .collapse-item {
                border-bottom: 1px solid theme('colors.grayBorder');
            }
            /* 折叠面板核心样式（修复联动逻辑） */
            .collapse-header {
                cursor: pointer;
            }
            .collapse-content {
                max-height: 0;
                opacity: 0;
                transition: all 0.4s ease-in-out;
                overflow: hidden;
                padding-top: 0;
            }
            /* 激活状态下展开内容 */
            .collapse-header.active + .collapse-content {
                max-height: 2000px;
                opacity: 1;
                padding-top: 1rem;
            }
            /* 折叠图标旋转动画（优化过渡） */
            .collapse-header i.fa-chevron-down {
                transition: transform 0.3s ease-in-out;
                display: inline-block; /* 确保旋转生效 */
            }
            .collapse-header.active i.fa-chevron-down {
                transform: rotate(180deg);
            }
            .step-card {
                border-left: 3px solid theme('colors.primaryLight');
                padding-left: 1rem;
                margin-bottom: 1.5rem;
                position: relative;
            }
            .step-card::before {
                content: '';
                position: absolute;
                left: -3px;
                top: 0;
                height: 100%;
                width: 3px;
                background: linear-gradient(to bottom, theme('colors.primary'), transparent);
                opacity: 0.3;
            }
            .table-hover-row {
                transition: background-color 0.2s ease;
            }
        }
    </style>
</head>
<body class="bg-light text-dark font-sans min-h-screen">
    <!-- 顶部导航 -->
    <!-- <nav class="bg-white shadow-sm sticky top-0 z-10">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <i class="fa fa-cubes text-primary text-xl"></i>
                <span class="font-medium text-lg text-secondary">供应链自动化流程</span>
            </div>
            <div class="text-sm text-gray">
                <span class="hidden sm:inline">泰国进销存2.0</span>
                <span class="mx-1">|</span>
                <span>商品销量报表自动化</span>
            </div>
        </div>
    </nav> -->

    <!-- 页面头部 -->
    <header class="py-8 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-white to-primaryLight">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-[clamp(22px,4vw,32px)] font-bold text-secondary mb-3">
                泰国_进销存自动化处理流程
            </h1>
            <p class="text-gray text-base sm:text-lg max-w-3xl mx-auto">
                供应链数据统计自动化方案 | 多仓报表导出 · 数据清洗 · 总表合并 · 公式计算
            </p>
        </div>
    </header>

    <main class="max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8 space-y-6">
        <!-- 板块1：业务背景 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-bullseye text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">一、业务背景</h2>
            </div>
            <!-- 实施目的 -->
            <div class="pl-12 text-base leading-relaxed text-dark/85 mb-6">
                <h3 class="font-medium text-dark mb-2">1.1 实施目的</h3>
                <p>供应链部门需对泰国站点的“泰国2仓（Tik Tok仓）、泰国5仓（Shopee仓）、泰国6仓（海沧）”商品销量报表进行导出、清洗、汇总统计。</p>
                <p class="mt-2">人工进行报表导出、数据合并、公式计算工作繁琐且易出错，通过<b class="text-primary">模块化自动化设计</b>，解决人工统计痛点，提升效率与数据准确性。</p>
            </div>
            <!-- 基本信息 -->
            <div class="pl-12 overflow-x-auto">
                <h3 class="font-medium text-dark mb-2">1.2 基础信息</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr class="bg-primaryLight text-left">
                            <th class="p-3 border border-grayBorder font-medium text-primary">流程名称</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">所属部门</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">操作频率</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">单次耗时</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">泰国_日销数据更新</td>
                            <td class="p-3 border border-grayBorder">供应链</td>
                            <td class="p-3 border border-grayBorder">按需执行（定时/手动触发）</td>
                            <td class="p-3 border border-grayBorder">自动化：5~10分钟</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 板块2：功能模块 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-desktop text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">二、功能模块</h2>
            </div>
            <!-- 应用系统 -->
            <div class="pl-12 mb-6">
                <h3 class="font-medium text-dark mb-2">2.1 涉及应用系统</h3>
                <p class="text-sm text-dark/80 mb-3">系统类型：浏览器网页/客户端 | 验证码类型：无</p>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse text-sm">
                        <thead>
                            <tr class="bg-primaryLight text-left">
                                <th class="p-3 border border-grayBorder font-medium text-primary">系统名称</th>
                                <th class="p-3 border border-grayBorder font-medium text-primary">类型</th>
                                <th class="p-3 border border-grayBorder font-medium text-primary">需账号密码</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">WPS（Excel）</td>
                                <td class="p-3 border border-grayBorder">客户端</td>
                                <td class="p-3 border border-grayBorder">无</td>
                            </tr>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">马帮ERP</td>
                                <td class="p-3 border border-grayBorder">浏览器网页</td>
                                <td class="p-3 border border-grayBorder">Yes</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- 模块概览 -->
            <div class="pl-12 overflow-x-auto">
                <h3 class="font-medium text-dark mb-2">2.2 核心模块概览</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr class="bg-primaryLight text-left">
                            <th class="p-3 border border-grayBorder font-medium text-primary">模块名称</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">涉及ERP</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">泰国2仓商品销量报表导出</td>
                            <td class="p-3 border border-grayBorder">马帮ERP</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">泰国5仓商品销量报表导出</td>
                            <td class="p-3 border border-grayBorder">马帮ERP</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">泰国6仓商品销量报表导出</td>
                            <td class="p-3 border border-grayBorder">马帮ERP</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">泰国各仓日销数据清洗</td>
                            <td class="p-3 border border-grayBorder">WPS（Excel）</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">泰国总日销数据合并</td>
                            <td class="p-3 border border-grayBorder">WPS（Excel）</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 板块3：异常处理机制 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-download text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">三、异常处理机制</h2>
            </div>
            <div class="pl-12 space-y-3" id="exception-section">
                <!-- 全部展开/收起按钮 -->
                <div class="collapse-header flex justify-between items-center py-3 px-4 bg-primaryLight/50 rounded-lg hover:bg-primaryLight/80" id="allCollapseBtn">
                    <span class="font-medium text-primary">展开/收起所有异常处理规则</span>
                    <i class="fa fa-chevron-down text-xs text-primary"></i>
                </div>

                <!-- 步骤1：马帮ERP登录 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤1：马帮ERP系统登录</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>执行登录前先退出原有马帮ERP登录状态，避免账号冲突</li>
                                <li>读取《配置文件.xlsx》中的账号密码登录，校验当前登录用户是否匹配</li>
                                <li>登录失败触发重试机制，重试次数耗尽则抛出异常并记录日志</li>
                                <li>浏览器窗口最大化加载，页面加载超时（600秒）则判定登录失败</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤2：泰国2仓报表导出 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤2：泰国2仓商品销量报表导出</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>页面加载状态持续检查（300秒），加载中状态未消失则判定加载失败</li>
                                <li>导出操作失败触发重试机制（次数由配置文件retry_times控制），每次失败记录日志</li>
                                <li>校验导出文件是否存在，不存在则重新导出；存在则记录路径并继续流程</li>
                                <li>日期筛选框输入超时、搜索按钮点击无响应则重新执行操作</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤3：泰国5仓报表导出 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤3：泰国5仓商品销量报表导出</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>仓库选择下拉框加载超时则刷新页面后重新选择</li>
                                <li>“另存为”对话框800秒未出现则判定导出异常，触发重试</li>
                                <li>导出文件路径不存在则自动创建对应仓库文件夹</li>
                                <li>重试次数耗尽仍失败则返回空路径，终止流程并抛出异常</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤4：泰国6仓报表导出 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤4：泰国6仓商品销量报表导出</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>校验报表数据更新状态，目标日期未更新则直接返回空路径</li>
                                <li>导出按钮点击无响应则激活浏览器窗口后重新点击</li>
                                <li>CSV文件编码异常则用UTF-8重新读取，避免乱码</li>
                                <li>文件下载完成后校验文件大小，空文件则重新导出</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤5：数据清洗异常 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤5：泰国各仓日销数据清洗</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>SKU在汇总表中不存在则自动创建30天0值数据，避免索引异常</li>
                                <li>Excel单元格样式重置失败则跳过样式重置，仅保留数据</li>
                                <li>公式计算出现#VALUE!则用IFERROR包裹公式，填充0值</li>
                                <li>文件读写权限不足则提示并终止流程，记录错误日志</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤6：总表合并异常 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤6：泰国总日销数据合并</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>多仓SKU不匹配则缺失SKU数据填充0值，避免合并失败</li>
                                <li>工作表删除/创建失败则关闭Excel进程后重新打开文件</li>
                                <li>公式批量写入超时则逐行写入，降低内存占用</li>
                                <li>文件保存失败则备份原有文件后重新保存</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 板块4：数据传输规范 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-filter text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">四、数据传输规范</h2>
            </div>
            <div class="pl-12 space-y-3" id="data-section">
                <!-- 全部展开/收起按钮 -->
                <div class="collapse-header flex justify-between items-center py-3 px-4 bg-primaryLight/50 rounded-lg hover:bg-primaryLight/80" id="allCollapseBtn2">
                    <span class="font-medium text-primary">展开/收起所有数据传输规则</span>
                    <i class="fa fa-chevron-down text-xs text-primary"></i>
                </div>

                <!-- 规则1：泰国2仓清洗 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则1：泰国2仓日销数据清洗</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>清空目标工作表所有单元格内容和格式，重置为默认样式</li>
                                <li>读取CSV格式的2仓销量数据，SKU作为主键匹配汇总表</li>
                                <li>删除最早1天的日销数据，新增当日销量数据至30天序列末尾</li>
                                <li>AF列（7天日销）写入公式=SUM(Y{行号}:AE{行号})/7，保留2位小数</li>
                                <li>AG列（14天日销）写入公式=SUM(R{行号}:AE{行号})/14，保留2位小数</li>
                                <li>AH列（30天日销）写入公式=SUM(B{行号}:AE{行号})/30，保留2位小数</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则2：泰国5仓清洗 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则2：泰国5仓日销数据清洗</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>同规则1步骤1-2，读取5仓CSV销量数据匹配汇总表SKU</li>
                                <li>校验当日销量数据，CSV中无该SKU则当日销量填充0值</li>
                                <li>30天日销序列更新规则同2仓（删最早1天，加当日数据）</li>
                                <li>7/14/30天日销公式与格式规范同2仓，确保计算逻辑统一</li>
                                <li>数据写入完成后校验列数，确保与表头匹配（34列：1列SKU+30列日期+3列公式）</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则3：泰国6仓清洗 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则3：泰国6仓日销数据清洗</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>同规则1步骤1-2，读取6仓CSV销量数据（UTF-8编码解析）</li>
                                <li>日期列生成规则：取近30天日期，表头第一列为“库存SKU”</li>
                                <li>SKU在汇总表中不存在则创建30天0值数据，避免数据缺失</li>
                                <li>公式写入后强制刷新Excel计算，确保数值实时更新</li>
                                <li>数据清洗完成后保存文件，不修改汇总表其他工作表数据</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则4：总日销合并 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则4：泰国总日销数据合并</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>删除汇总表原有“泰国总日销”工作表，重新创建并置于末尾</li>
                                <li>读取2/5/6仓日销数据，以SKU为键累加各日期销量数据</li>
                                <li>缺失SKU在对应仓库的销量数据填充0值，确保数据完整性</li>
                                <li>按日期列顺序排列数据，表头与各仓日销表保持一致</li>
                                <li>批量写入7/14/30天日销公式，格式统一为保留2位小数</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则5：公式计算规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则5：公式计算与格式规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>7天日销：取最近7天（Y-AE列）销量求和后除以7，格式0.00</li>
                                <li>14天日销：取最近14天（R-AE列）销量求和后除以14，格式0.00</li>
                                <li>30天日销：取全部30天（B-AE列）销量求和后除以30，格式0.00</li>
                                <li>公式使用Excel原生SUM函数，避免第三方库计算误差</li>
                                <li>空值/异常值通过IFERROR处理，默认返回0.00</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则6：文件更新规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header flex justify-between items-center py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则6：配置文件更新规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>汇总表保存为“泰国进销存表_当日日期.xlsx”，存放在原路径</li>
                                <li>更新《配置文件.xlsx》中“导入文件路径”工作表B2单元格为新汇总表路径</li>
                                <li>文件保存前关闭所有Excel进程，避免文件占用</li>
                                <li>保存后校验文件完整性，确保工作表、数据、公式均正常</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 板块5：系统依赖 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-upload text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">五、系统依赖</h2>
            </div>
            <div class="pl-12 space-y-4">
                <!-- 环境依赖 -->
                <div class="bg-primaryLight/30 rounded-lg p-4">
                    <h3 class="font-medium text-primary mb-2">5.1 运行环境依赖</h3>
                    <ul class="list-disc pl-6 text-sm space-y-1">
                        <li>操作系统：Windows 10/11 64位</li>
                        <li>浏览器：Google Chrome 90.0+（需登录马帮ERP账号）</li>
                        <li>办公软件：WPS Office 2021+（Excel组件）</li>
                        <li>运行时：Python 3.8+（需安装以下库）：
                            <ul class="list-circle pl-4 mt-1">
                                <li>pandas：数据清洗与合并</li>
                                <li>openpyxl：Excel文件读写与公式写入</li>
                                <li>win32com：Excel进程管理</li>
                                <li>pyautogui：模拟鼠标键盘操作</li>
                                <li>xlrd：CSV/Excel文件读取</li>
                            </ul>
                        </li>
                    </ul>
                </div>
                <!-- 权限依赖 -->
                <div class="bg-primaryLight/30 rounded-lg p-4">
                    <h3 class="font-medium text-primary mb-2">5.2 权限依赖</h3>
                    <ul class="list-disc pl-6 text-sm space-y-1">
                        <li>马帮ERP：供应链模块-商品销量报表查看/导出权限</li>
                        <li>本地文件：报表存放路径（如\\192.168.3.223\传输\供应链）读写权限</li>
                        <li>Excel文件：汇总表/配置文件的编辑/保存/删除权限</li>
                        <li>系统权限：终止WPS/Chrome进程的管理员权限</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <!-- 折叠面板交互逻辑（修复版） -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 通用折叠面板切换函数
            const toggleCollapse = (header) => {
                header.classList.toggle('active');
                const icon = header.querySelector('i.fa-chevron-down');
                if (icon) {
                    // 直接通过active类控制旋转，无需单独设置style
                    icon.style.transform = header.classList.contains('active') ? 'rotate(180deg)' : 'rotate(0)';
                }
            };

            // 1. 绑定所有单个折叠面板的点击事件
            const allSingleHeaders = document.querySelectorAll('.collapse-item .collapse-header');
            allSingleHeaders.forEach(header => {
                header.addEventListener('click', function() {
                    toggleCollapse(this);
                });
            });

            // 2. 全部展开/收起 - 异常处理板块
            const allCollapseBtn = document.getElementById('allCollapseBtn');
            if (allCollapseBtn) {
                allCollapseBtn.addEventListener('click', function() {
                    toggleCollapse(this);
                    const isActive = this.classList.contains('active');
                    // 获取当前板块下的所有单个折叠面板
                    const singleHeaders = document.querySelector('#exception-section').querySelectorAll('.collapse-item .collapse-header');
                    singleHeaders.forEach(header => {
                        if (isActive) {
                            header.classList.add('active');
                            header.querySelector('i.fa-chevron-down').style.transform = 'rotate(180deg)';
                        } else {
                            header.classList.remove('active');
                            header.querySelector('i.fa-chevron-down').style.transform = 'rotate(0)';
                        }
                    });
                });
            }

            // 3. 全部展开/收起 - 数据传输规范板块
            const allCollapseBtn2 = document.getElementById('allCollapseBtn2');
            if (allCollapseBtn2) {
                allCollapseBtn2.addEventListener('click', function() {
                    toggleCollapse(this);
                    const isActive = this.classList.contains('active');
                    // 获取当前板块下的所有单个折叠面板
                    const singleHeaders = document.querySelector('#data-section').querySelectorAll('.collapse-item .collapse-header');
                    singleHeaders.forEach(header => {
                        if (isActive) {
                            header.classList.add('active');
                            header.querySelector('i.fa-chevron-down').style.transform = 'rotate(180deg)';
                        } else {
                            header.classList.remove('active');
                            header.querySelector('i.fa-chevron-down').style.transform = 'rotate(0)';
                        }
                    });
                });
            }
        });
    </script>
</body>
</html>
