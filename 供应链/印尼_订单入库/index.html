<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>印尼-订单入库</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        primaryLight: '#E8F3FF',
                        primaryDark: '#0E42CC',
                        secondary: '#0E2B8A',
                        light: '#F9FBFF',
                        dark: '#1D2129',
                        gray: '#86909C',
                        grayLight: '#F0F2F5',
                        grayBorder: '#E5E6EB'
                    },
                    fontFamily: {
                        sans: ['Microsoft YaHei', 'PingFang SC', 'sans-serif']
                    },
                    boxShadow: {
                        'card': '0 2px 12px 0 rgba(0, 0, 0, 0.05)',
                        'card-hover': '0 6px 16px 0 rgba(0, 0, 0, 0.08)',
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .collapse-item {
                border-bottom: 1px solid theme('colors.grayBorder');
            }
            /* 折叠面板核心样式（修复点击区域+优先级+动画） */
            .collapse-header {
                cursor: pointer;
                transition: all 0.2s ease;
                width: 100%;
                display: flex;
                justify-content: space-between;
                align-items: center;
                position: relative;
                z-index: 10; /* 确保点击层级最高 */
            }
            .collapse-header > * {
                pointer-events: none; /* 子元素不拦截点击，确保整个header可点 */
            }
            .collapse-header > i {
                pointer-events: auto; /* 箭头单独可点 */
                cursor: pointer;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: transform 0.3s ease-in-out !important;
            }
            .collapse-content {
                max-height: 0;
                opacity: 0;
                transition: all 0.4s ease-in-out;
                overflow: hidden;
                padding-top: 0;
                padding-left: 0.5rem;
            }
            /* 提升选择器优先级，确保展开样式生效 */
            .collapse-header.active + .collapse-content {
                max-height: 2000px !important;
                opacity: 1 !important;
                padding-top: 1rem !important;
                padding-bottom: 0.5rem !important;
            }
            /* 折叠图标旋转动画（强制生效） */
            .collapse-header.active > i.fa-chevron-down {
                transform: rotate(180deg) !important;
            }
            .step-card {
                border-left: 3px solid theme('colors.primaryLight');
                padding-left: 1rem;
                margin-bottom: 1.5rem;
                position: relative;
            }
            .step-card::before {
                content: '';
                position: absolute;
                left: -3px;
                top: 0;
                height: 100%;
                width: 3px;
                background: linear-gradient(to bottom, theme('colors.primary'), transparent);
                opacity: 0.3;
            }
            .table-hover-row {
                transition: background-color 0.2s ease;
            }
        }
    </style>
</head>
<body class="bg-light text-dark font-sans min-h-screen">
    
    <!-- 页面头部 -->
    <header class="py-8 px-4 sm:px-6 lg:px-8 bg-gradient-to-b from-white to-primaryLight">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-[clamp(22px,4vw,32px)] font-bold text-secondary mb-3">
                印尼-订单入库自动化处理流程
            </h1>
            <p class="text-gray text-base sm:text-lg max-w-3xl mx-auto">
                印尼对内表格解析 · 马帮ERP验货入库 · 调拨记录生成 · 入库回执单导出 | 替代人工操作，提升印尼采购单入库流程效率与准确性
            </p>
        </div>
    </header>

    <main class="max-w-4xl mx-auto py-8 px-4 sm:px-6 lg:px-8 space-y-6">
        <!-- 板块1：业务背景 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-bullseye text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">一、业务背景</h2>
            </div>
            <!-- 实施目的 -->
            <div class="pl-12 text-base leading-relaxed text-dark/85 mb-6">
                <h3 class="font-medium text-dark mb-2">1.1 实施目的</h3>
                <p>供应链部门需处理印尼对内表格的采购单验货入库+调拨记录生成流程，从指定模板文件读取当日采购单数据（采购单号、运输方式、入库数量、运单号、仓库编码等），自动完成马帮ERP系统的验货入库操作（采购单搜索、SKU编号获取、确认入库），并为入库成功的记录生成调拨发货记录（运单号备注、发货操作），最终生成入库回执单（含入库状态/失败原因）。</p>
                <p class="mt-2">人工处理上述流程繁琐且易出错，通过<b class="text-primary">全流程自动化设计</b>，解决人工登录ERP、采购单搜索、入库操作、调拨发货等痛点，提升印尼采购单入库流程的效率与准确性。</p>
            </div>
            <!-- 基本信息 -->
            <div class="pl-12 overflow-x-auto">
                <h3 class="font-medium text-dark mb-2">1.2 基础信息</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr class="bg-primaryLight text-left">
                            <th class="p-3 border border-grayBorder font-medium text-primary">流程名称</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">所属部门</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">操作频率</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">核心价值</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">海仓_马帮ERP_印尼订单入库</td>
                            <td class="p-3 border border-grayBorder">供应链</td>
                            <td class="p-3 border border-grayBorder">每日执行（基于当日印尼对内表格数据）</td>
                            <td class="p-3 border border-grayBorder">自动化验货入库+调拨发货，减少人工重复操作，降低入库流程错误率</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 板块2：功能模块 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-desktop text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">二、功能模块</h2>
            </div>
            <!-- 应用系统 -->
            <div class="pl-12 mb-6">
                <h3 class="font-medium text-dark mb-2">2.1 涉及应用系统</h3>
                <p class="text-sm text-dark/80 mb-3">系统类型：浏览器网页/客户端 | 验证码类型：无</p>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse text-sm">
                        <thead>
                            <tr class="bg-primaryLight text-left">
                                <th class="p-3 border border-grayBorder font-medium text-primary">系统名称</th>
                                <th class="p-3 border border-grayBorder font-medium text-primary">类型</th>
                                <th class="p-3 border border-grayBorder font-medium text-primary">需账号密码</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">马帮ERP</td>
                                <td class="p-3 border border-grayBorder">浏览器网页</td>
                                <td class="p-3 border border-grayBorder">Yes</td>
                            </tr>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">WPS/Excel</td>
                                <td class="p-3 border border-grayBorder">客户端</td>
                                <td class="p-3 border border-grayBorder">无</td>
                            </tr>
                            <tr class="table-hover-row hover:bg-primaryLight/50">
                                <td class="p-3 border border-grayBorder">Windows系统</td>
                                <td class="p-3 border border-grayBorder">操作系统</td>
                                <td class="p-3 border border-grayBorder">无（依赖系统权限）</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- 模块概览 -->
            <div class="pl-12 overflow-x-auto">
                <h3 class="font-medium text-dark mb-2">2.2 核心模块概览</h3>
                <table class="w-full border-collapse text-sm">
                    <thead>
                        <tr class="bg-primaryLight text-left">
                            <th class="p-3 border border-grayBorder font-medium text-primary">模块名称</th>
                            <th class="p-3 border border-grayBorder font-medium text-primary">涉及系统</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">马帮ERP登录与身份校验</td>
                            <td class="p-3 border border-grayBorder">马帮ERP + Windows</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">进程清理（WPS/Chrome）</td>
                            <td class="p-3 border border-grayBorder">Windows系统</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">印尼对内表格数据解析（采购单号/运输方式等）</td>
                            <td class="p-3 border border-grayBorder">WPS/Excel + Python</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">马帮ERP验货入库操作（搜索/入库确认）</td>
                            <td class="p-3 border border-grayBorder">马帮ERP + xbot</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">马帮ERP调拨记录生成与发货</td>
                            <td class="p-3 border border-grayBorder">马帮ERP + xbot</td>
                        </tr>
                        <tr class="table-hover-row hover:bg-primaryLight/50">
                            <td class="p-3 border border-grayBorder">入库回执单生成与导出</td>
                            <td class="p-3 border border-grayBorder">WPS/Excel + Python</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 板块3：异常处理机制 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-exclamation-triangle text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">三、异常处理机制</h2>
            </div>
            <div class="pl-12 space-y-3" id="exception-section">
                <!-- 全部展开/收起按钮 -->
                <div class="collapse-header flex justify-between items-center py-3 px-4 bg-primaryLight/50 rounded-lg hover:bg-primaryLight/80" id="allCollapseBtn">
                    <span class="font-medium text-primary">展开/收起所有异常处理规则</span>
                    <i class="fa fa-chevron-down text-xs text-primary"></i>
                </div>

                <!-- 步骤1：进程清理异常 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤1：进程清理（WPS/Chrome）</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>WPS进程清理失败（taskkill /F /IM "wps.exe" /T）则忽略异常，继续后续流程</li>
                                <li>Chrome进程关闭失败则强制终止（task_kill=True），避免进程冲突</li>
                                <li>进程清理异常不终止主流程，仅记录日志后继续执行</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤2：表格解析异常 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤2：印尼对内表格数据解析</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>模板文件不存在则抛出异常，终止整个流程（提示“本次处理不存在印尼对内表格”）</li>
                                <li>当日无匹配数据（时间字段≠当日）则抛出异常，终止流程（提示“模板中不存在任何数据”）</li>
                                <li>采购单号重复时，复用已获取的SKU编号，标记失败原因为“采购单号重复”</li>
                                <li>字段索引获取失败（如采购单号/运输方式列不存在）则抛出KeyError异常</li>
                                <li>日期格式解析失败（非“YYYY-MM-DD”格式）则强制截取日期部分，保留原始值</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤3：马帮ERP登录/页面异常 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤3：马帮ERP登录/页面加载</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>页面加载超时（800秒）则重建浏览器窗口，重新访问目标页面</li>
                                <li>店铺授权提醒弹窗出现时，自动勾选“7天内不再重复提醒”并点击确认</li>
                                <li>调拨页面获取失败时，重新执行马帮ERP登录流程后重试</li>
                                <li>页面元素定位失败（如输入框/按钮不存在）则记录异常并标记入库状态为失败</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤4：验货入库操作异常 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤4：马帮ERP验货入库操作</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>采购单搜索无结果则标记入库状态为失败，失败原因为“搜索后暂无内容”</li>
                                <li>SKU编号元素不存在则标记失败原因为“该记录无法进行入库，请确认”</li>
                                <li>确认入库按钮点击后，1分钟内未出现“入库成功”提示则抛出异常，标记失败原因为“入库成功信息超时”</li>
                                <li>复选框/入库按钮点击超时（10次重试）则抛出“click timeout”异常</li>
                                <li>单个采购单处理异常不终止批量流程，仅标记该记录失败后继续处理下一条</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 步骤5：调拨记录生成异常 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">步骤5：调拨记录生成与发货</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <p class="mb-2 font-medium text-dark/80">异常处理规则：</p>
                            <ul class="list-disc pl-6 space-y-1 mb-3 text-sm">
                                <li>调拨页面搜索无结果则标记失败原因为“未查询到调拨记录（备注：采购单号）”</li>
                                <li>发货备注填写后，30秒内未出现“操作成功”弹窗则标记失败原因为“分仓调拨备注失败”</li>
                                <li>发货按钮点击后，30秒内未出现确认弹窗则跳过该步骤，标记失败</li>
                                <li>调拨页面加载失败则重新登录马帮ERP后重试，最多重试指定次数</li>
                                <li>发货确认操作异常则关闭当前页面，标记失败后继续处理下一条</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 板块4：数据传输规范 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-exchange text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">四、数据传输规范</h2>
            </div>
            <div class="pl-12 space-y-3" id="data-section">
                <!-- 全部展开/收起按钮 -->
                <div class="collapse-header flex justify-between items-center py-3 px-4 bg-primaryLight/50 rounded-lg hover:bg-primaryLight/80" id="allCollapseBtn2">
                    <span class="font-medium text-primary">展开/收起所有数据传输规则</span>
                    <i class="fa fa-chevron-down text-xs text-primary"></i>
                </div>

                <!-- 规则1：表格解析规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则1：印尼对内表格数据解析规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>日期筛选：仅提取“时间”字段等于当日（YYYY-MM-DD）的记录</li>
                                <li>字段提取：采购单号、运输方式、总数量(Pcs)、运单号、仓库编码（固定为“中印”）</li>
                                <li>采购单号去重：通过集合跟踪重复采购单号，避免重复处理</li>
                                <li>键值定义：采购单号_运输方式作为唯一键，存储运输方式/总数量/运单号/仓库编码</li>
                                <li>数据类型：所有字段强制转为字符串类型，避免数值解析异常</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则2：验货入库数据规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则2：验货入库数据传输规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>搜索规则：采购单号输入后按Enter键触发搜索，等待5秒加载结果</li>
                                <li>SKU获取：从“马帮_供应链_签收入库_库存SKU编号”元素提取文本作为SKU编号</li>
                                <li>状态记录：入库成功标记“成功”，异常则记录具体失败原因</li>
                                <li>重复处理：重复采购单号复用已获取的SKU编号，不重复执行入库操作</li>
                                <li>超时规则：入库成功提示等待60秒，未出现则判定为失败</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则3：调拨记录生成规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则3：调拨记录生成规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>运输方式适配：“陆运”自动转换为“陆地运输”，其他方式保持原样</li>
                                <li>备注规则：发货备注填写运单号，追加模式（append=True）避免覆盖原有内容</li>
                                <li>搜索规则：按采购单号搜索调拨记录，等待加载完成后执行操作</li>
                                <li>发货规则：点击发货按钮后等待确认弹窗，确认后等待5秒完成操作</li>
                                <li>异常降级：调拨失败不回滚入库状态，仅标记该记录调拨失败</li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 规则4：回执单生成规范 -->
                <div class="collapse-item py-2">
                    <div class="collapse-header py-2 px-0 group">
                        <span class="font-medium text-dark group-hover:text-primary transition-colors">规则4：入库回执单生成规范</span>
                        <i class="fa fa-chevron-down text-xs text-gray group-hover:text-primary"></i>
                    </div>
                    <div class="collapse-content pl-2 text-gray">
                        <div class="step-card">
                            <ol class="list-decimal pl-6 space-y-1 text-sm">
                                <li>字段定义：采购单号、运输方式、入库数量、运单号、SKU编号、仓库编码、入库状态、失败原因</li>
                                <li>命名规则：{当前时间戳（含毫秒）}_印尼入库回执单.xlsx</li>
                                <li>存储路径：输出文件夹（glv['output_file_folder']），路径不存在则依赖系统自动创建</li>
                                <li>数据填充：每条采购单处理完成后实时更新回执单状态，确保数据最新</li>
                                <li>格式规范：所有字段为字符串类型，避免Excel自动格式化数值</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 板块5：系统依赖 -->
        <section class="bg-white rounded-xl p-6 shadow-card hover:shadow-card-hover transition-shadow duration-300">
            <div class="flex items-center mb-4">
                <div class="w-9 h-9 rounded-full bg-primary/10 flex items-center justify-center mr-3">
                    <i class="fa fa-cogs text-primary"></i>
                </div>
                <h2 class="text-xl sm:text-2xl font-semibold text-dark">五、系统依赖</h2>
            </div>
            <div class="pl-12 space-y-4">
                <div class="bg-grayLight p-4 rounded-lg">
                    <h3 class="font-medium text-dark mb-2">5.1 基础环境</h3>
                    <ul class="list-disc pl-6 space-y-1 text-sm">
                        <li>操作系统：Windows（依赖taskkill、subprocess等系统命令/进程管理）</li>
                        <li>编程语言：Python 3.x</li>
                        <li>网络环境：可访问马帮ERP官网（https://www.mabangerp.com）</li>
                        <li>权限要求：Windows系统管理员权限（进程管理/文件读写）</li>
                    </ul>
                </div>
                <div class="bg-grayLight p-4 rounded-lg">
                    <h3 class="font-medium text-dark mb-2">5.2 核心Python库</h3>
                    <ul class="list-disc pl-6 space-y-1 text-sm">
                        <li>自动化类：xbot（网页/客户端自动化）、xbot_visual（图像识别/加载状态检测）</li>
                        <li>数据处理类：pandas（Excel/CSV解析）、openpyxl/xlrd（Excel读写）</li>
                        <li>系统操作类：os（文件/目录操作）、subprocess/system（进程管理）、time（时间处理）</li>
                        <li>日志/异常类：xbot.app.logging（日志记录）、traceback（异常追踪）</li>
                        <li>扩展类：win32com（键盘操作）、uuid（唯一标识，可选）</li>
                    </ul>
                </div>
                <div class="bg-grayLight p-4 rounded-lg">
                    <h3 class="font-medium text-dark mb-2">5.3 自定义模块依赖</h3>
                    <ul class="list-disc pl-6 space-y-1 text-sm">
                        <li>登录模块：mb_login_timeout2、mb_login、hc_login、hc_again_login（马帮ERP登录）</li>
                        <li>工具模块：tools（文件路径获取、日期处理等通用工具）</li>
                        <li>全局变量：package.variables（登录信息、文件路径、重试次数等）</li>
                        <li>通用工具类：CommonUtil（元素点击封装，含重试/超时处理）</li>
                    </ul>
                </div>
            </div>
        </section>
    </main>

    <!-- 交互逻辑脚本 -->
    <script>
        // 通用折叠面板切换函数
        function toggleCollapse(header) {
            header.classList.toggle('active');
            // 同步更新图标样式（冗余保障）
            const icon = header.querySelector('i.fa-chevron-down');
            if (icon) {
                if (header.classList.contains('active')) {
                    icon.style.transform = 'rotate(180deg)';
                } else {
                    icon.style.transform = 'rotate(0deg)';
                }
            }
        }

        // 绑定单个折叠面板点击事件
        document.querySelectorAll('.collapse-item .collapse-header').forEach(header => {
            header.addEventListener('click', function() {
                toggleCollapse(this);
            });
        });

        // 绑定异常板块全部展开/收起
        document.getElementById('allCollapseBtn').addEventListener('click', function() {
            const isActive = this.classList.contains('active');
            // 切换自身状态
            toggleCollapse(this);
            // 切换所有子面板
            document.querySelectorAll('#exception-section .collapse-item .collapse-header').forEach(header => {
                if (isActive) {
                    header.classList.remove('active');
                    const icon = header.querySelector('i.fa-chevron-down');
                    if (icon) icon.style.transform = 'rotate(0deg)';
                } else {
                    header.classList.add('active');
                    const icon = header.querySelector('i.fa-chevron-down');
                    if (icon) icon.style.transform = 'rotate(180deg)';
                }
            });
        });

        // 绑定数据规范板块全部展开/收起
        document.getElementById('allCollapseBtn2').addEventListener('click', function() {
            const isActive = this.classList.contains('active');
            // 切换自身状态
            toggleCollapse(this);
            // 切换所有子面板
            document.querySelectorAll('#data-section .collapse-item .collapse-header').forEach(header => {
                if (isActive) {
                    header.classList.remove('active');
                    const icon = header.querySelector('i.fa-chevron-down');
                    if (icon) icon.style.transform = 'rotate(0deg)';
                } else {
                    header.classList.add('active');
                    const icon = header.querySelector('i.fa-chevron-down');
                    if (icon) icon.style.transform = 'rotate(180deg)';
                }
            });
        });

        // 初始化：确保样式生效（修复初始状态图标旋转）
        document.querySelectorAll('.collapse-header.active i.fa-chevron-down').forEach(icon => {
            icon.style.transform = 'rotate(180deg)';
        });
    </script>
</body>
</html>
